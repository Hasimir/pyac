[tox]
envlist = lint,doc,py36

[testenv]
deps =
    coverage
    pytest
    pgpy>=0.4.1
    emailpgp

commands =
    pytest
    coverage run --rcfile={toxinidir}/.coveragerc --source=autocrypt -m pytest -vs {toxinidir}/tests

[testenv:doc]
deps =
    sphinx
    pgpy>=0.4.1
whitelist_externals = make
changedir = docs
commands =
    make html

[testenv:lint]
skip_install = True
#usedevelop = True
deps =
    flake8
    restructuredtext_lint
    check-manifest
commands =
    #check-manifest
    rst-lint README.rst CHANGELOG.rst
    flake8 --max-line-length 79 \
      --exclude=tests/data,autocrypt/tests_data.py autocrypt tests

[testenv:stats]
skip_install = True
changedir={toxinidir}
deps =
   coverage
   # codecov
commands=
   coverage combine
   coverage report
   coverage html
   # only to run from travis
   # codecov
   # coveralls

[pytest]
addopts = -rsvvxX
